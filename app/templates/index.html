<!DOCTYPE html>
<html>
<head>
	<title>AgriDigital Sprint Dashboard</title>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/style.css') }}">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

</head>
<body>

	<div class="jumbotron">
		<h1>AgriDigital Sprint Dashboard</h1>
	</div>
	<div class="container-fluid">
		<table class="table table-condensed">
			<thead>
				<tr>
					<th>Issue Key</th>
					<th>Issue Type   </th>
					<th>Summary</th>
					<th>Subtask   </th>
					<th>Status               </th>
					<th>Original Estimate</th>
					<th>Time Spent</th>
					<th>Remaining Time</th>
					<th>Progress</th>
					<th>Dev In Progress</th>
					<th>To Do</th>
					<th>Done</th>
					<th>Dev Review</th>
					<th>Awaiting UAT</th>
				</tr>
			</thead>
			<tbody>
				{% for issue in stories %}
					<tr class="row_story">

						<td>{{ issue.key }}</td>
						<td>{{ issue.issuetype }}</td>
						<td class="cell_summary">{{ issue.summary }}</td>
						<td>{{ issue.subtasks|length }}</td>
						<td>{{ issue.status }}</td>
						<td class="cell_time">{% if issue.aggregatetimeoriginalestimate != None %}{{ issue.aggregatetimeoriginalestimate_str }}{% endif %}</td>
						<td class="cell_time">{% if issue.aggregatetimespent != None %}{{ issue.aggregatetimespent_str }}{% endif %}</td>
						<td class="cell_time">{% if issue.aggregatetimeestimate != None %}{{ issue.aggregatetimeestimate_str }}{% endif %}</td>
						
						<td class="cell_progress"><span class="progress_percentage">{{ issue.progress }}%</span><span class="progress" style="height: 10px"><div class="progress-bar" role="progressbar" style="height: 10px; width: {{ issue.progress }}%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div></span></td>

						<td class="cell_status_count">{{ issue.subtask_status_count['Dev In Progress'] }}</td>
						<td class="cell_status_count">{{ issue.subtask_status_count['To Do'] }}</td>
						<td class="cell_status_count">{{ issue.subtask_status_count['Done'] }}</td>
						<td class="cell_status_count">{{ issue.subtask_status_count['Dev Review'] }}</td>
						<td class="cell_status_count">{{ issue.subtask_status_count['Awaiting UAT'] }}</td>


						{% if issue.subtasks|length > 0 %}

							{% for subtask in issue.subtasks %}

								<tr class="row_subtask">
									
									<td>{{ subtask.key }}</td>
									<td>{{ subtask.issuetype }}</td>
									<td class="cell_summary">{{ subtask.summary }}</td>
									<td>{{ subtask.devteam }}</td>
									<td>{{ subtask.status }}</td>
									<td class="cell_time">{% if subtask.aggregatetimeoriginalestimate != None %}{{ subtask.aggregatetimeoriginalestimate_str }}{% endif %}</td>
									<td class="cell_time">{% if subtask.aggregatetimespent != None %}{{ subtask.aggregatetimespent_str }}{% endif %}</td>
									<td class="cell_time">{% if subtask.aggregatetimeestimate != None %}{{ subtask.aggregatetimeestimate_str }}{% endif %}</td>
									<td class="cell_progress"></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
								</tr>

							{% endfor %}

						{% endif %}

					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</body>

<script type="text/javascript">
	
	$('.row_story').click(function(){
		$(this).nextUntil('tr.row_story').slideToggle(200);
	});
	

</script>


</html>